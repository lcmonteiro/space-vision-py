# ################################################################################################
# ---------------------------------------------------------------------------------------
# File:   find_text_query.py
# Author: Luis Monteiro
#
# Created on nov 8, 2019, 22:00 PM
# ---------------------------------------------------------------------------------------
# ################################################################################################

# external
from re              import match

# internal
from vision.library  import VisionQuery

# ################################################################################################
# ---------------------------------------------------------------------------------------
# VisionFilterText
# ---------------------------------------------------------------------------------------
# ################################################################################################
class FindTextQuery(VisionQuery):

    # -------------------------------------------------------------------------
    # initialization
    # -------------------------------------------------------------------------
    def __init__(self, db):
        super().__init__(db)
    
    # -------------------------------------------------------------------------
    # process
    # -------------------------------------------------------------------------
    def __call__(self, collection, time_interval, label_pattern):
        def process(results):
            for result in reversed(results):
                if match(label_pattern, result.label()):
                    return result.label()
            return None
        return self.process(collection, time_interval, process)
         
# ################################################################################################
# ------------------------------------------------------------------------------------------------
# End
# ------------------------------------------------------------------------------------------------
# ################################################################################################
