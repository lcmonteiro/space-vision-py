# ################################################################################################
# ------------------------------------------------------------------------------------------------
# File:   vision_config.py
# Author: Luis Monteiro
#
# Created on nov 8, 2019, 22:00 PM
# ------------------------------------------------------------------------------------------------
# ################################################################################################

# external imports
import numpy as np

# ------------------------------------------------------------------------------------------------
# Sliding Window
# ------------------------------------------------------------------------------------------------
def sliding_window(data, step, shape):
    from numpy.lib.stride_tricks import as_strided
    # utils
    dsd = np.array(data.strides)
    dsh = np.array(data.shape)    
    # normalize
    isd = np.concatenate((step , np.ones(len(dsd) - len(step))))
    ish = np.concatenate((shape, dsh[len(shape):]             ))
    # compute strides & shape
    sd = np.concatenate((((dsd      ) * isd)    , dsd)).astype(np.int)
    sh = np.concatenate((((dsh - ish) / isd) + 1, ish)).astype(np.int)
    # apply strides & shape
    return as_strided(data, strides=sd, shape=sh, writeable=False)
    
# ################################################################################################
# ------------------------------------------------------------------------------------------------
# End
# ------------------------------------------------------------------------------------------------
# ################################################################################################